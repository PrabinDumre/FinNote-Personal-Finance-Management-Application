<!-- views/index.hbs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My FinNote - Login</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="login-card">
            <div class="left-section">
                <div class="text-content">
                    <h1>FinNote</h1>
                    <p class="subtitle">Effortlessly Track Expenses & Organize Notes</p>
                    <div class="logo-container">
                    <svg width="517" height="499" viewBox="0 0 517 499" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g filter="url(#filter0_d_178_12)">
                        <g filter="url(#filter1_i_178_12)">
                        <rect x="0.501465" y="196.376" width="396.132" height="347.29" rx="60" transform="rotate(-29.6939 0.501465 196.376)" fill="white"/>
                        </g>
                        <g filter="url(#filter2_i_178_12)">
                        <rect x="0.501465" y="196.376" width="396.132" height="347.29" rx="60" transform="rotate(-29.6939 0.501465 196.376)" fill="url(#paint0_linear_178_12)"/>
                        </g>
                        <rect x="1.18349" y="196.563" width="395.132" height="346.29" rx="59.5" transform="rotate(-29.6939 1.18349 196.563)" stroke="black"/>
                        <g clip-path="url(#clip0_178_12)">
                        <path d="M192.126 425.917L452.818 277.258L334.904 70.4812L74.2121 219.141L192.126 425.917ZM321.936 108.322L371.048 194.445L411.516 265.41L202.962 384.338L162.494 313.373L113.383 227.25L321.936 108.322Z" fill="#46997D"/>
                        <g clip-path="url(#clip1_178_12)">
                        <path d="M261.892 240.159L275.812 232.221L271.954 225.454L263.999 229.99L262.07 226.607L254.116 231.143L256.141 234.696C253.963 236.491 252.48 238.882 251.98 241.405C251.481 243.927 252.001 246.402 253.438 248.347C254.876 250.293 257.13 251.571 259.761 251.933C262.393 252.295 265.215 251.716 267.68 250.308L271.657 248.04C272.184 247.739 272.792 247.629 273.346 247.734C273.899 247.838 274.354 248.149 274.61 248.598C274.866 249.046 274.902 249.596 274.71 250.126C274.518 250.656 274.113 251.122 273.586 251.423L259.666 259.361L263.524 266.128L271.479 261.591L273.408 264.975L281.362 260.439L279.337 256.886C281.515 255.091 282.998 252.7 283.497 250.177C283.997 247.654 283.477 245.18 282.039 243.235C280.602 241.289 278.348 240.011 275.717 239.649C273.085 239.286 270.263 239.866 267.798 241.274L263.821 243.542C263.294 243.843 262.686 243.953 262.132 243.848C261.579 243.744 261.124 243.433 260.868 242.984C260.612 242.536 260.576 241.986 260.768 241.456C260.96 240.926 261.364 240.459 261.892 240.159Z" fill="black"/>
                        <path d="M309.678 208.425L301.644 213.007C300.005 210.399 297.751 208.207 295.02 206.566C292.289 204.924 289.139 203.869 285.767 203.464L278.335 190.432C277.977 189.804 277.42 189.306 276.727 188.993C276.034 188.68 275.232 188.564 274.411 188.66C273.59 188.756 272.783 189.059 272.079 189.535C271.376 190.011 270.804 190.641 270.428 191.355L260.983 209.294L242.421 219.879C220.507 232.376 211.037 252.306 218.29 269.506L218.083 269.624C217.028 270.226 215.813 270.446 214.705 270.237C213.598 270.028 212.688 269.406 212.176 268.509L208.318 261.743L200.364 266.279L204.222 273.045C205.76 275.734 208.489 277.597 211.811 278.224C215.133 278.851 218.776 278.192 221.941 276.39L222.22 276.231C225.326 280.339 229.46 283.651 234.341 285.942C239.221 288.232 244.733 289.446 250.5 289.501L257.143 301.149C257.654 302.047 258.564 302.668 259.672 302.877C260.779 303.087 261.994 302.866 263.049 302.265L278.958 293.193C280.013 292.591 280.821 291.658 281.205 290.598C281.589 289.538 281.518 288.439 281.006 287.541L277.147 280.775L289.079 273.971L292.938 280.737C293.449 281.635 294.359 282.256 295.467 282.465C296.574 282.674 297.789 282.454 298.844 281.852L314.753 272.78C315.808 272.179 316.616 271.246 317 270.186C317.384 269.126 317.313 268.027 316.801 267.129L310.313 255.752C312.523 252.954 314.054 249.804 314.783 246.556C315.512 243.308 315.418 240.053 314.508 237.054L323.183 232.107C324.237 231.506 325.046 230.572 325.43 229.513C325.814 228.453 325.742 227.353 325.231 226.456L315.585 209.54C315.073 208.643 314.163 208.022 313.055 207.813C311.948 207.603 310.733 207.824 309.678 208.425ZM315.347 227.609L303.908 234.132C308.007 244.137 307.359 247.789 299.808 255.815L306.917 268.282L298.963 272.818L293.175 262.669L265.335 278.545L271.122 288.694L263.168 293.23L256.18 280.977C250.286 281.771 244.5 281.016 239.503 278.801C234.506 276.586 230.504 273.003 227.967 268.471C218.639 252.114 230.443 235.676 246.28 226.645L267.494 214.547L274.239 201.735L279.595 211.126C292.8 211.935 293.35 217.566 297.699 224.223L309.559 217.46L315.347 227.609Z" fill="black"/>
                        <g clip-path="url(#clip2_178_12)">
                        <path d="M297.212 326.662L230.008 341.97L251.608 319.164L288.202 310.86L363.593 231.215L394.219 224.238L297.212 326.662Z" fill="#46997D"/>
                        </g>
                        </g>
                        </g>
                        <defs>
                        <filter id="filter0_d_178_12" x="18.3342" y="21.1526" width="484.206" height="463.076" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                        <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
                        <feOffset dy="4"/>
                        <feGaussianBlur stdDeviation="2"/>
                        <feComposite in2="hardAlpha" operator="out"/>
                        <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
                        <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_178_12"/>
                        <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_178_12" result="shape"/>
                        </filter>
                        <filter id="filter1_i_178_12" x="22.3342" y="7.97827" width="486.483" height="468.25" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                        <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                        <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
                        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
                        <feOffset dx="14" dy="-14"/>
                        <feGaussianBlur stdDeviation="7"/>
                        <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
                        <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.25 0"/>
                        <feBlend mode="normal" in2="shape" result="effect1_innerShadow_178_12"/>
                        </filter>
                        <filter id="filter2_i_178_12" x="22.3342" y="17.9783" width="476.483" height="458.25" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                        <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                        <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
                        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
                        <feOffset dx="14" dy="-14"/>
                        <feGaussianBlur stdDeviation="2"/>
                        <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
                        <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
                        <feBlend mode="normal" in2="shape" result="effect1_innerShadow_178_12"/>
                        </filter>
                        <linearGradient id="paint0_linear_178_12" x1="30.8273" y1="543.666" x2="347.713" y2="172.849" gradientUnits="userSpaceOnUse">
                        <stop offset="0.0281401" stop-color="#75FFD1" stop-opacity="0.4"/>
                        <stop offset="1" stop-color="#46997D"/>
                        </linearGradient>
                        <clipPath id="clip0_178_12">
                        <rect width="360.12" height="317.379" fill="white" transform="matrix(0.868684 -0.495366 -0.495366 -0.868684 185.71 475.246)"/>
                        </clipPath>
                        <clipPath id="clip1_178_12">
                        <rect width="146.511" height="124.625" fill="white" transform="translate(169.258 230.217) rotate(-29.6939)"/>
                        </clipPath>
                        <clipPath id="clip2_178_12">
                        <rect width="254.927" height="77.2678" fill="white" transform="translate(181.602 316.908) rotate(-29.6939)"/>
                        </clipPath>
                        </defs>
                        </svg>
                </div>
                </div>
            </div>
            <div class="right-section">
                <div class="login-content">
                    <h2>LOG IN</h2>
                    
                    <!-- Display Flash Messages -->
                    <div id="loginMessage" class="alert" style="display: none;"></div>

                    <!-- Corrected Login Form -->
                    <form class="login-form">
                        <div class="input-group">
                            <input type="email" placeholder="YOUR EMAIL" name="email" required>
                            <span class="icon">✉️</span>
                        </div>
                        <div class="input-group">
                            <input type="password" placeholder="Password" name="password" id="loginPassword" required>
                            <button type="button" class="toggle-password" aria-label="Toggle password visibility">
                                <svg class="eye-icon visible" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                                    <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                                </svg>
                                <svg class="eye-icon hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" style="display: none;">
                                    <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                                </svg>
                            </button>
                            <span class="icon">🔒</span>
                        </div>
                        <div class="forgot-password">
                            <a href="forgot-password.html">Forgot Password?</a>
                        </div>
                        <button type="submit" class="login-btn">Login</button>
                        <p class="account-switch">Don't have an account? <a href="signup.html">Sign Up</a></p>
                    </form>
                </div>

                <div class="signup-section">
                    <div class="quote-section">
                        <p class="quote">"Track your money, plan with ease, and build a future you'll love—because smart budgeting today means financial freedom tomorrow!"</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup Message Handling -->
    <style>
        .toggle-password {
            position: absolute;
            right: 40px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.7;
            transition: opacity 0.3s ease;
            z-index: 1;
        }

        .toggle-password:hover {
            opacity: 1;
        }

        .eye-icon {
            width: 20px;
            height: 20px;
            fill: #666;
        }

        .input-group {
            position: relative;
        }

        .input-group input[type="password"],
        .input-group input[type="text"] {
            padding-right: 70px;
        }

        .quote-section {
            text-align: center;
            padding: 10px;
            margin-top: 0;
        }

        .quote {
            font-style: italic;
            color: #46997D;
            font-size: 1.1em;
            line-height: 1.4;
            margin: 0;
            padding: 0 20px;
        }

        .signup-section {
            margin-top: 10px;
        }

        /* Alert Message Styles */
        .alert {
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            font-weight: 500;
            text-align: center;
            transition: all 0.3s ease;
            animation: slideInDown 0.3s ease;
        }

        .alert.error {
            background-color: #fee;
            color: #c53030;
            border: 1px solid #feb2b2;
            box-shadow: 0 2px 4px rgba(197, 48, 48, 0.1);
        }

        .alert.success {
            background-color: #f0fff4;
            color: #2f855a;
            border: 1px solid #9ae6b4;
            box-shadow: 0 2px 4px rgba(47, 133, 90, 0.1);
        }

        .alert.warning {
            background-color: #fffbeb;
            color: #d69e2e;
            border: 1px solid #fbd38d;
            box-shadow: 0 2px 4px rgba(214, 158, 46, 0.1);
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Loading state for button */
        .login-btn:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .login-btn:disabled:hover {
            background-color: #95a5a6;
        }
    </style>

    <script>
    window.addEventListener('DOMContentLoaded', () => {
        if (localStorage.getItem('showLoginMessage') === 'true') {
            localStorage.removeItem('showLoginMessage');
            const popup = document.getElementById('popup');
            popup.classList.add('show');
            setTimeout(() => {
                popup.classList.remove('show');
            }, 3000);
        }

        const togglePassword = document.querySelector('.toggle-password');
        const passwordInput = document.querySelector('#loginPassword');
        const visibleEye = togglePassword.querySelector('.visible');
        const hiddenEye = togglePassword.querySelector('.hidden');

        togglePassword.addEventListener('click', function() {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            
            if (type === 'password') {
                visibleEye.style.display = 'block';
                hiddenEye.style.display = 'none';
            } else {
                visibleEye.style.display = 'none';
                hiddenEye.style.display = 'block';
            }
        });

        // Login form submission handling
        const loginForm = document.querySelector('.login-form');
        const loginMessage = document.getElementById('loginMessage');

        loginForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.querySelector('input[name="email"]').value;
            const password = document.querySelector('#loginPassword').value;

            // Basic validation
            if (!email || !password) {
                showLoginMessage('Please fill in all fields', 'error');
                return;
            }

            if (!isValidEmail(email)) {
                showLoginMessage('Please enter a valid email address', 'error');
                return;
            }

            try {
                // Show loading state
                const submitBtn = loginForm.querySelector('button[type="submit"]');
                const originalText = submitBtn.textContent;
                submitBtn.textContent = 'Logging in...';
                submitBtn.disabled = true;

                // For demo purposes, simulate a successful login
                // In a real application, this would be an API call
                setTimeout(() => {
                    // Store login state in localStorage
                    localStorage.setItem('isLoggedIn', 'true');
                    localStorage.setItem('userEmail', email);
                    
                    showLoginMessage('Login successful! Redirecting...', 'success');
                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 1000);
                }, 1500); // Simulate network delay

                // Uncomment the code below when you have a backend server
                /*
                const response = await fetch('/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();

                if (response.ok && data.success) {
                    showLoginMessage('Login successful! Redirecting...', 'success');
                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 1000);
                } else {
                    // Handle different error scenarios
                    let errorMessage = 'Invalid credentials';
                    
                    if (data.error) {
                        switch(data.error) {
                            case 'user_not_found':
                                errorMessage = 'No account found with this email address';
                                break;
                            case 'invalid_password':
                                errorMessage = 'Incorrect password';
                                break;
                            case 'account_locked':
                                errorMessage = 'Account is temporarily locked. Please try again later';
                                break;
                            case 'email_not_verified':
                                errorMessage = 'Please verify your email address before logging in';
                                break;
                            default:
                                errorMessage = data.message || 'Invalid credentials';
                        }
                    }
                    
                    showLoginMessage(errorMessage, 'error');
                }
                */
            } catch (error) {
                console.error('Login error:', error);
                showLoginMessage('Network error. Please check your connection and try again', 'error');
            } finally {
                // Reset button state
                const submitBtn = loginForm.querySelector('button[type="submit"]');
                submitBtn.textContent = 'Login';
                submitBtn.disabled = false;
            }
        });

        function showLoginMessage(message, type) {
            loginMessage.textContent = message;
            loginMessage.className = `alert ${type}`;
            loginMessage.style.display = 'block';
            
            // Auto-hide success messages after 3 seconds
            if (type === 'success') {
                setTimeout(() => {
                    loginMessage.style.display = 'none';
                }, 3000);
            }
            
            // Auto-hide error messages after 5 seconds
            if (type === 'error') {
                setTimeout(() => {
                    loginMessage.style.display = 'none';
                }, 5000);
            }
        }

        function isValidEmail(email) {
            // Only allow common domains
            const allowedDomains = [
                'gmail.com',
                'yahoo.com',
                'outlook.com',
                'hotmail.com',
                'icloud.com'
            ];
            const emailRegex = /^[^\s@]+@([^\s@]+)$/;
            const match = email.match(emailRegex);
            if (!match) return false;
            const domain = match[1].toLowerCase();
            return allowedDomains.some(d => domain.endsWith(d));
        }

        // Clear message when user starts typing
        document.querySelector('input[name="email"]').addEventListener('input', function() {
            if (loginMessage.style.display === 'block') {
                loginMessage.style.display = 'none';
            }
        });

        document.querySelector('#loginPassword').addEventListener('input', function() {
            if (loginMessage.style.display === 'block') {
                loginMessage.style.display = 'none';
            }
        });
    });
    </script>
    
    <div id="popup" class="popup">Please log in to continue</div>

</body>
</html>
